{{- $activeSeriesNames := slice -}}
{{- range .Site.Data.series -}}
  {{- if not .manual -}}
    {{- $activeSeriesNames = $activeSeriesNames | append .name -}}
  {{- end -}}
{{- end -}}
{{- $pages := where (where .Site.RegularPages "Type" "posts") "Params.series" "in" $activeSeriesNames -}}
{{- $pages = where $pages "Draft" "ne" true -}}
{{- $pages = where $pages "Params.noindex" "ne" true -}}
{{- $pages = sort $pages "Date" "desc" -}}
[
{{- range $index, $page := $pages }}
  {{- if $index }},{{ end }}
  {
    "title": {{ $page.Title | jsonify }},
    "series": {{ $page.Params.series | default "" | jsonify }},
    "date": "{{ $page.Date.Format "2006-01-02T15:04:05Z07:00" }}",
    "url": {{ $page.Permalink | jsonify }},
    "tags": {{ $page.Params.tags | default (slice) | jsonify }},
    "summary": {{ $page.Summary | plainify | jsonify }}
  }
{{- end }}
]
